<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Launcher with Apps</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
      background: url('wallpaper.jpg') center/cover no-repeat;
      font-family: sans-serif;
      overflow: hidden;
      padding: 20px;
    }
    .launcher {
      position: fixed;
      bottom: 20px;
      left: 20px;
      padding: 10px 20px;
      border-radius: 8px;
      background: rgba(0,0,0,0.5);
      color: white;
      cursor: pointer;
      z-index: 1000;
    }
    .launcher-menu {
      display: none;
      position: fixed;
      bottom: 70px;
      left: 20px;
      width: 300px;
      max-height: 400px;
      background: rgba(0,0,0,0.8);
      border-radius: 10px;
      padding: 10px;
      color: white;
      overflow-y: auto;
      z-index: 999;
    }
    .search-bar {
      width: 100%;
      padding: 5px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: none;
    }
    .app-button {
      display: block;
      width: 100%;
      margin: 5px 0;
      padding: 10px;
      border-radius: 6px;
      background: rgba(255,255,255,0.2);
      text-align: center;
      cursor: pointer;
    }
    /* Desktop icons */
    .desktop-icon {
      width: 100px;
      height: 100px;
      margin: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      cursor: pointer;
      border-radius: 10px;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(5px);
      text-align: center;
    }
    .desktop-icon img {
      max-width: 70px;
      max-height: 70px;
    }
    .desktop-icon span {
      margin-top: 5px;
      color: white;
      font-size: 14px;
    }
    .window {
      position: absolute;
      top: 100px;
      left: 100px;
      width: 800px;
      height: 500px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      display: none;
      flex-direction: column;
      overflow: hidden;
      z-index: 500;
    }
    .window-header {
      background: #222;
      color: white;
      padding: 8px;
      cursor: move;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .window iframe, .window .content {
      flex-grow: 1;
      border: none;
      width: 100%;
      height: 100%;
    }
    .close-btn, .fullscreen-btn {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      margin-left: 5px;
    }
  </style>
</head>
<body>

<div class="launcher">Launcher</div>
<div class="launcher-menu">
  <input type="text" class="search-bar" placeholder="Search apps...">
  <div class="app-button" data-app="granny">Granny Game</div>
  <div class="app-button" data-app="wallpaper">Change Wallpaper</div>
</div>

<!-- Desktop Granny Icon -->
<div class="desktop-icon" id="desktop-granny">
  <img src="granny-logo.png" alt="Granny Game">
  <span>Granny</span>
</div>

<div class="window" id="app-window">
  <div class="window-header">
    <span class="title">App</span>
    <div>
      <button class="fullscreen-btn">⛶</button>
      <button class="close-btn">✖</button>
    </div>
  </div>
  <iframe id="app-frame"></iframe>
  <div class="content" id="wallpaper-content" style="display:none; padding:10px;">
    <input type="file" id="wallpaperInput" accept="image/*">
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const launcher = document.querySelector(".launcher");
    const launcherMenu = document.querySelector(".launcher-menu");
    const searchBar = document.querySelector(".search-bar");
    const appButtons = document.querySelectorAll(".app-button");
    const appWindow = document.getElementById("app-window");
    const appFrame = document.getElementById("app-frame");
    const wallpaperContent = document.getElementById("wallpaper-content");
    const wallpaperInput = document.getElementById("wallpaperInput");
    const closeBtn = document.querySelector(".close-btn");
    const fullscreenBtn = document.querySelector(".fullscreen-btn");
    const header = appWindow.querySelector(".window-header");
    const desktopGranny = document.getElementById("desktop-granny");

    let isDragging = false, offsetX, offsetY;
    let maximized = false;

    launcher.addEventListener("click", () => {
      launcherMenu.style.display = launcherMenu.style.display === "block" ? "none" : "block";
    });

    searchBar.addEventListener("input", () => {
      const query = searchBar.value.toLowerCase();
      appButtons.forEach(btn => {
        btn.style.display = btn.textContent.toLowerCase().includes(query) ? "block" : "none";
      });
    });

    function openGranny() {
      appFrame.src = "https://maddox.page/basic-ruffle-player/html/granny/index.html";
      appFrame.style.display = "block";
      wallpaperContent.style.display = "none";
      appWindow.style.display = "flex";
    }

    appButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        if (btn.dataset.app === "granny") openGranny();
        if (btn.dataset.app === "wallpaper") {
          appFrame.style.display = "none";
          wallpaperContent.style.display = "block";
          appWindow.style.display = "flex";
        }
      });
    });

    desktopGranny.addEventListener("click", openGranny);

    closeBtn.addEventListener("click", () => {
      appWindow.style.display = "none";
      appFrame.src = "";
    });

    fullscreenBtn.addEventListener("click", () => {
      if (!maximized) {
        appWindow.style.top = "0";
        appWindow.style.left = "0";
        appWindow.style.width = "100vw";
        appWindow.style.height = "100vh";
      } else {
        appWindow.style.top = "100px";
        appWindow.style.left = "100px";
        appWindow.style.width = "800px";
        appWindow.style.height = "500px";
      }
      maximized = !maximized;
    });

    header.addEventListener("mousedown", e => {
      isDragging = true;
      offsetX = e.clientX - appWindow.offsetLeft;
      offsetY = e.clientY - appWindow.offsetTop;
      if (maximized) {
        maximized = false;
        appWindow.style.width = "800px";
        appWindow.style.height = "500px";
      }
    });

    document.addEventListener("mousemove", e => {
      if (isDragging) {
        appWindow.style.left = (e.clientX - offsetX) + "px";
        appWindow.style.top = (e.clientY - offsetY) + "px";
      }
    });

    document.addEventListener("mouseup", () => { isDragging = false; });

    wallpaperInput.addEventListener("change", e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = event => {
          document.body.style.background = `url('${event.target.result}') center/cover no-repeat`;
        };
        reader.readAsDataURL(file);
      }
    });
  });
</script>
</body>
</html>
