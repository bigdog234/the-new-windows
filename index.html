<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Custom Launcher with Sign-In</title>
<style>
  body {
    margin: 0;
    font-family: sans-serif;
    background: #222;
    color: white;
    height: 100vh;
    overflow: hidden;
  }
  .auth-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.8);
    padding: 20px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    width: 300px;
    gap: 10px;
  }
  .auth-container input {
    padding: 8px;
    border-radius: 5px;
    border: none;
    outline: none;
  }
  .auth-container button {
    padding: 8px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    background: #0b122b;
    color: white;
  }
  #launcher {
    position: fixed;
    bottom: 20px;
    left: 20px;
    padding: 10px 20px;
    border-radius: 8px;
    background: rgba(0,0,0,0.5);
    color: white;
    cursor: pointer;
    z-index: 1000;
    display: none;
  }
  #launcher-apps {
    display: none;
    position: absolute;
    width: 100%;
    height: 100%;
  }
  .desktop-icon {
      width: 100px;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      cursor: pointer;
      border-radius: 10px;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(5px);
      text-align: center;
      position: absolute;
  }
  .desktop-icon img {
      max-width: 70px;
      max-height: 70px;
  }
  .desktop-icon span {
      margin-top: 5px;
      color: white;
      font-size: 14px;
  }
  .context-menu {
      position: absolute;
      background: rgba(0,0,0,0.9);
      border: 1px solid white;
      border-radius: 5px;
      display: none;
      flex-direction: column;
      z-index: 2000;
  }
  .context-menu button {
      padding: 5px 10px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      text-align: left;
  }
  .context-menu button:hover {
      background: rgba(255,255,255,0.2);
  }
</style>
</head>
<body>

<div id="auth-page" class="auth-container">
  <h2>Sign In</h2>
  <input type="text" id="signin-username" placeholder="Username">
  <input type="password" id="signin-password" placeholder="Password">
  <button id="signin-btn">Sign In</button>
  <p>Or <span id="show-signup" style="color:yellow; cursor:pointer;">Sign Up</span></p>
</div>

<div id="signup-page" class="auth-container" style="display:none;">
  <h2>Sign Up</h2>
  <input type="text" id="signup-username" placeholder="Username">
  <input type="password" id="signup-password" placeholder="Password">
  <button id="signup-btn">Sign Up</button>
  <p>Already have an account? <span id="show-signin" style="color:yellow; cursor:pointer;">Sign In</span></p>
</div>

<div id="launcher">Launcher</div>

<div id="launcher-apps">
  <div class="desktop-icon" id="granny-icon" style="top:50px; left:50px;">
    <img src="granny-logo.png" alt="Granny Game">
    <span>Granny</span>
  </div>
  <div class="desktop-icon" id="wallpaper-icon" style="top:50px; left:180px;">
    <img src="wallpaper-icon.png" alt="Wallpaper">
    <span>Wallpaper</span>
  </div>
</div>

<div class="context-menu" id="context-menu">
  <button id="move-app-btn">Move App</button>
</div>

<script>
  const authPage = document.getElementById('auth-page');
  const signupPage = document.getElementById('signup-page');
  const launcherApps = document.getElementById('launcher-apps');
  const launcherBtn = document.getElementById('launcher');
  const showSignup = document.getElementById('show-signup');
  const showSignin = document.getElementById('show-signin');
  const signupBtn = document.getElementById('signup-btn');
  const signinBtn = document.getElementById('signin-btn');
  const grannyIcon = document.getElementById('granny-icon');
  const wallpaperIcon = document.getElementById('wallpaper-icon');
  const contextMenu = document.getElementById('context-menu');
  const moveAppBtn = document.getElementById('move-app-btn');

  let isMoving = false;
  let currentIcon = null;
  let currentUser = null;

  showSignup.addEventListener('click', () => { authPage.style.display = 'none'; signupPage.style.display = 'flex'; });
  showSignin.addEventListener('click', () => { signupPage.style.display = 'none'; authPage.style.display = 'flex'; });

  function saveUserData(username, data) { localStorage.setItem('user_'+username, JSON.stringify(data)); }
  function getUserData(username) { const data = localStorage.getItem('user_'+username); return data ? JSON.parse(data) : null; }

  signupBtn.addEventListener('click', () => {
    const username = document.getElementById('signup-username').value.trim();
    const password = document.getElementById('signup-password').value.trim();
    if (!username || !password) return alert('Fill in all fields');
    if (getUserData(username)) return alert('Username exists');
    const data = { password, wallpaper: 'wallpaper.jpg', icons: { granny: { top:50, left:50 }, wallpaper: { top:50, left:180 } } };
    saveUserData(username, data);
    currentUser = username;
    alert('Account created!');
    signupPage.style.display='none';
    launcherApps.style.display='block';
    launcherBtn.style.display='block';
    applyUserData(data);
  });

  signinBtn.addEventListener('click', () => {
    const username = document.getElementById('signin-username').value.trim();
    const password = document.getElementById('signin-password').value.trim();
    const userData = getUserData(username);
    if (!userData) return alert('User not found');
    if (userData.password !== password) return alert('Wrong password');
    currentUser = username;
    authPage.style.display='none';
    launcherApps.style.display='block';
    launcherBtn.style.display='block';
    applyUserData(userData);
  });

  function applyUserData(data){
    document.body.style.background = `url('${data.wallpaper}') center/cover no-repeat`;
    if(data.icons){
      grannyIcon.style.top = data.icons.granny.top+'px';
      grannyIcon.style.left = data.icons.granny.left+'px';
      wallpaperIcon.style.top = data.icons.wallpaper.top+'px';
      wallpaperIcon.style.left = data.icons.wallpaper.left+'px';
    }
  }

  launcherBtn.addEventListener('click', () => {
    launcherApps.style.display = launcherApps.style.display === 'block' ? 'none' : 'block';
  });

  function setupIconDragging(icon){
    icon.addEventListener('contextmenu', e => {
      e.preventDefault();
      currentIcon = icon;
      contextMenu.style.top = e.clientY + 'px';
      contextMenu.style.left = e.clientX + 'px';
      contextMenu.style.display = 'flex';
    });
  }

  [grannyIcon, wallpaperIcon].forEach(icon => setupIconDragging(icon));

  document.addEventListener('click', e => { if(!contextMenu.contains(e.target)) contextMenu.style.display = 'none'; });

  moveAppBtn.addEventListener('click', () => { isMoving = true; contextMenu.style.display = 'none'; });

  document.addEventListener('mousemove', e => {
    if(isMoving && currentIcon){
      currentIcon.style.left = e.clientX - 50 + 'px';
      currentIcon.style.top = e.clientY - 50 + 'px';
    }
  });

  document.addEventListener('mouseup', () => {
    if(isMoving){
      isMoving = false;
      if(currentUser && currentIcon){
        const data = getUserData(currentUser);
        if(currentIcon.id === 'granny-icon') data.icons.granny = { top: parseInt(currentIcon.style.top), left: parseInt(currentIcon.style.left) };
        if(currentIcon.id === 'wallpaper-icon') data.icons.wallpaper = { top: parseInt(currentIcon.style.top), left: parseInt(currentIcon.style.left) };
        saveUserData(currentUser, data);
        currentIcon = null;
      }
    }
  });

  grannyIcon.addEventListener('dblclick', () => {
    window.open('https://maddox.page/basic-ruffle-player/html/granny/index.html', '_blank');
  });

  wallpaperIcon.addEventListener('dblclick', () => {
    const newWallpaper = prompt('Enter wallpaper URL:');
    if(newWallpaper && currentUser){
      const data = getUserData(currentUser);
      data.wallpaper = newWallpaper;
      saveUserData(currentUser, data);
      document.body.style.background = `url('${newWallpaper}') center/cover no-repeat`;
    }
  });
</script>
</body>
</html>
